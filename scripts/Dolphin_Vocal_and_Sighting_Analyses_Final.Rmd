---
title: "Nlme Vocals and Sightings"
output: html_document
---


```{r}
library(scales)
library(MASS)
library(ggplot2)
library(ggpubr)
library(car)
library(RColorBrewer)
library(DTK)
```

Testing the model first -- 
```{r}
dolphinz <- read.csv("~/Desktop/Sighting Data/dsite.csv")
dolph_month <- read.csv("~/Desktop/Sighting Data/dmonth.csv")

dolphinz$site <- as.factor(dolphinz$site)
dolphinz$season <- as.factor(dolphinz$season)


dolph_month$season <- as.factor(dolph_month$season)
```


```{r}
theme_Publication <- function(base_size=12, base_family="helvetica") {
      library(grid)
      library(ggthemes)
      (theme_foundation(base_size=base_size, base_family=base_family)
       + theme(plot.title = element_text(size = rel(1.2), hjust = 0.5),
               text = element_text(),
               panel.background = element_rect(colour = NA),
               plot.background = element_rect(colour = NA),
               panel.border = element_rect(colour = NA),
               axis.title = element_text(size = rel(1.0)),
               axis.title.y = element_text(angle=90,vjust =2),
               axis.title.x = element_text(vjust = -0.2),
               axis.text = element_text(), 
               axis.line = element_line(colour="black"),
               axis.ticks = element_line(),
               panel.grid.major = element_line(colour="#f0f0f0"),
               panel.grid.minor = element_blank(),
               legend.key = element_rect(colour = NA),
               legend.position = "right",
               legend.text = element_text(size = rel(1)),
               #legend.key.size= unit(0.5, "mm"),
               #legend.spacing = unit(0.5, "mm"),
               legend.title = element_text(face="italic", size = rel(1.0)),
               #plot.margin=unit(c(10,5,5,5),"mm"),
               strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
               strip.text = element_text()
          ))
      
}

scale_fill_Publication <- function(...){
      library(scales)
      discrete_scale("fill","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)

}

scale_colour_Publication <- function(...){
      library(scales)
      discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)

}
```



```{r}
par(mfrow=c(1,2))
hist(dolphinz$total,  xlab = "Total Number of Vocalizations", breaks = 8, main = "Vocalization Frequency")  
hist(dolphinz$dolphin,  xlab = "Total Number of Dolphins", main = "Sighting Frequency") 
```

```{r}
par(mfrow=c(2,3))
hist(stna$total,  xlab = "Total Number of Vocalizations", main = "Wando Terminal") 
hist(stnb$total,  xlab = "Total Number of Vocalizations", main = "Confluence") 
hist(stnc$total,  xlab = "Total Number of Vocalizations", main = "Aquarium") 
hist(stna$dolphin,  xlab = "Total Number of Dolphins", main = "Wando Terminal") 
hist(stnb$dolphin,  xlab = "Total Number of Dolphins", main = "Confluence") 
hist(stnc$dolphin,  xlab = "Total Number of Dolphins", main = "Aquarium") 
```
```{r}
par(mfrow=c(2,3))
hist(stnd$total,  xlab = "Total Number of Vocalizations", main = "Harbor Mouth") 
hist(stne$total,  xlab = "Total Number of Vocalizations", main = "Lower Ashley") 
hist(stnf$total,  xlab = "Total Number of Vocalizations", main = "Upper Ashley") 
hist(stnd$dolphin,  xlab = "Total Number of Dolphins", main = "Harbor Mouth") 
hist(stne$dolphin,  xlab = "Total Number of Dolphins", main = "Lower Ashley") 
hist(stnf$dolphin,  xlab = "Total Number of Dolphins", main = "Upper Ashley") 
```

TOTAL - Basic regression
```{r}
#log.lm1 <- lm(dolphin ~ log1p(total) + calf + site + season + toad + perch, data = dolphinz)
#summary(log.lm1)
#plot(log.lm1)
#Multiple regression overfitting the data, move forward with glm and then tukeys hsd mult comparisons for factors and correlations for continuous variables that are significant. 

log.glm <- glm(log1p(dolphin) ~ log1p(total) + site + calf + toad, data = dolphinz)
summary(log.glm)
plot(log.glm)
```

```{r}
shapiro.test(dolphinz$dolphin)
shapiro.test(dolphinz$total)
```

```{r}
alog.glm <- aov(log.glm)
summary(alog.glm)
```
```{r}
#elog.glm <- glm(log1p(dolphin) ~ log1p(total) + site + season + calf + toad, data = dolphinz)
#summary(elog.glm)
#plot(elog.glm)

#nblog.glm <- glm.nb(dolphin ~ total + site + season + calf + toad, data = dolphinz)
#summary(nblog.glm)
#plot(nblog.glm)
#AIC 633.28

```

```{r}
stepAIC(log.glm)
#drop season
```

```{r}
library(DTK)
TK.total <- TK.test(dolphinz$total, dolphinz$site, a=0.05)
TK.total
```
```{r}
#Pearson Correlations to further assess relationships with continuous variables
#Calf variable (p < 0.001 ) correlations with total dolphins sighted and total vocalizations detected
# dolphin ~ calf
ggscatter(dolphinz, x = "calf", y = "dolphin",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Total Calves Sighted", ylab = "Total Dolphins Sighted")+
  stat_cor(aes(x=calf, y=log1p(dolphin)), label.x = 7)

# total vocals ~ calf 
ggscatter(dolphinz, x = "calf", y = "total",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Total Calves Sighted", ylab = "Total Vocalizations Detected")+
  stat_cor(aes(x=calf, y=log1p(total)), label.x = 7)


#Total vocal variable (p < 0.001 ) correlation with total dolphins sighted 
# dolphin ~ total vocals
ggscatter(dolphinz, x = "total", y = "dolphin",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Total Vocalizations Detected", ylab = "Total Dolphins Sighted")+
  stat_cor(aes(x=log1p(total), y=log1p(dolphin)), label.x = 7)


#Toadfish variable (fish calling scores summed monthly across sites; p < 0.038) correlations with total #dolphins sighted and vocalizations detected
#dolphin ~ toad fish call score sums
ggscatter(dolphinz, x = "toad", y = "dolphin",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Summed Toadfish Calling Scores", ylab = "Total Dolphins Sighted")+
  stat_cor(aes(x=toad, y=log1p(dolphin)), label.x = 7)

#total vocals ~ toad fish call score sums
ggscatter(dolphinz, x = "toad", y = "total",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Summed Toadfish Calling Scores", ylab = "Total Vocalizations Detected")+
  stat_cor(aes(x=toad, y=log1p(total)), label.x = 7)

```

```{r}
par(mfrow=c(1,2))

plot(predict(log.glm), log1p(dolphinz$dolphin), xlab='Predicted Dolphins', ylab='Observed Dolphins', main = 'Model Predictability')
abline(a=0, b=1)

plot(predict(log.glm, type='response'), residuals(log.glm, type='response'), xlab='Fitted values', ylab='Residuals', main='Residuals vs Fitted Values')

```
```{r}
library(car)
Anova(log.glm)
#remove drum, trout, noiseratio
```

```{r}
#QUESTION ON THESE TYPES OF PLOTS - Since I am including other factors (# of calves, season, and 
# fish call score sums) dooes this matter when making/showing these kinds of plots? 

library(ggplot2) 

(prelim_plot <- ggplot(dolphinz, aes(x = log1p(total), y = log1p(dolphin))) +
  geom_point() +
  geom_smooth(method = "glm"))

```

log+1 Transformation with Site color code
```{r}
#with glm
(mm_plot <- ggplot(dolphinz, aes(x = log1p(total), y = log1p(dolphin))) +
      facet_wrap(~site, nrow=2) +   
      geom_point(alpha = 0.5, colour = "darkred") +
      theme_classic() +
      theme(legend.position = "none",
            panel.spacing = unit(2, "lines"))  # adding space between panels
)
```
log+1 transformed 
```{r}
#season
(colour_plot <- ggplot(dolphinz, aes(x = log1p(total), y = log1p(dolphin))) +
  facet_wrap(~season, nrow=2) + 
  geom_point(alpha = 0.5, colour = "darkred") + 
  theme_classic() +
  theme(legend.position = "none")+ labs(x="Total Vocalizations Detected", y = "Total Dolphins Sighted"))

```

```{r}
my_BuPu <- brewer.pal(n = 9, "BuPu")[3:9]

modtotal <- ggplot(dolphinz, aes((log1p(total)),(log1p(dolphin)))) +
  geom_point(aes(group = site, color = site),  size = 3.5)+
  xlab("Total Vocalizations Detected") + ylab("Total Dolphins Sighted") +
  scale_color_manual(name = "Survey Area", values  = my_BuPu)+
  scale_y_continuous(breaks = pretty_breaks()) + 
  theme_classic() +
  scale_x_continuous(breaks = pretty_breaks())
modtotal


modtotalszn <- ggplot(dolphinz, aes((log1p(total)),(log1p(dolphin)))) +
  geom_point(aes(group = season, color = season),  size = 3.5)+
  xlab("Total Vocalizations Detected") + ylab("Total Dolphins Sighted") +
  scale_color_manual(name = "Season", values  = my_BuPu)+
  scale_y_continuous(breaks = pretty_breaks()) + 
  theme_classic() +
  scale_x_continuous(breaks = pretty_breaks())
modtotalszn
```

```{r}
#Dolphin sightings and vocalizations boxplots across recorder sites/survey areas

dolph_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(dolphin), fill = site)) +
  geom_boxplot(show.legend=F) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866","#386cb0","#fdb462","#7fc97f")) +
  labs(x="Survey Area", y="Total Dolphins Sighted")

dolph_boxplot

vocals_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(total), fill = site)) +
  geom_boxplot(show.legend=F) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866","#386cb0","#fdb462","#7fc97f")) +
  labs(x="Survey Area", y="Total Vocalizations Detected")

vocals_boxplot
```

```{r}
#Dolphin sightings and vocalizations boxplots broken down further across seasons in first portion
site_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(dolphin), fill = season)) +
  geom_boxplot(show.legend=T) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866" )) + labs(x="Survey Area", y="Total Dolphins Sighted")

site_boxplot


vsite_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(total), fill = season)) +
  geom_boxplot(show.legend=T) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866" )) + labs(x="Survey Area", y="Total Vocalizations Detected")

vsite_boxplot
```


ECHO Basic regression
```{r}
elog.glm <- glm(log1p(dolphin) ~ log1p(echo) + calf + site + season + toad + perch, data = dolphinz)
summary(elog.glm)
plot(elog.glm)
echolog.glm <- aov(elog.glm)
summary(echolog.glm)
```

```{r}
stepAIC(elog.glm)
```


```{r}
#Tukeys 
library(DTK)
TK.echo <- TK.test(dolphinz$echo, dolphinz$site, a=0.05)
TK.echo

TK.eszn <- TK.test(dolphinz$echo, dolphinz$season, a=0.05)
TK.eszn
```

```{r}
#Pearson Correlations to further assess relationships with continuous variables
#Calf variable (p < 0.001 ) correlations with total dolphins sighted and total vocalizations detected
# total vocals ~ calf 
ggscatter(dolphinz, x = "calf", y = "echo",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Total Calves Sighted", ylab = "Total Echo Bouts Detected")+
  stat_cor(aes(x=log1p(echo), y=calf), label.x = 7)


#Total vocal variable (p < 0.001 ) correlation with total dolphins sighted 
# dolphin ~ total vocals
ggscatter(dolphinz, x = "echo", y = "dolphin",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Total Echo Bouts Detected", ylab = "Total Dolphins Sighted")+
  stat_cor(aes(x=log1p(echo), y=log1p(dolphin),), label.x = 7)


#Toadfish variable (fish calling scores summed monthly across sites; p < 0.038) correlations with total #dolphins sighted and vocalizations detected
#echo bouts ~ toad fish call score sums
ggscatter(dolphinz, x = "toad", y = "echo",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Summed Toadfish Calling Scores", ylab = "Total Echo Bouts Detected")+
  stat_cor(aes(x=toad, y=log1p(echo)), label.x = 7)

```

```{r}
par(mfrow=c(1,2))

plot(predict(elog.glm), log1p(dolphinz$dolphin), xlab='Predicted Dolphins', ylab='Observed Dolphins', main = 'Model Predictability')
abline(a=0, b=1)

plot(predict(elog.glm, type='response'), residuals(log.lm, type='response'), xlab='Fitted values', ylab='Residuals', main='Residuals vs Fitted Values')
```
```{r}
Anova(elog.glm)
#remove drum, trout, noiseratio
```

```{r}
stepAIC(elog.glm)
```

```{r}
library(ggplot2)  # load the package

par(mfrow=c(2,2))
(prelim_plot <- ggplot(dolphinz, aes(x = log1p(echo), y = log1p(dolphin))) +
  geom_point() + theme_classic() +
  geom_smooth(method = "glm"))


```

```{r}
#Echo bout boxplots across recorder sites/survey areas

#dolphin ~ site
echo_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(echo), fill = site)) +
  geom_boxplot(show.legend=F) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866","#386cb0","#fdb462","#7fc97f")) +
  labs(x="Survey Area", y="Total Echo Bouts Sighted")

echo_boxplot

esite_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(echo), fill = season)) +
  geom_boxplot(show.legend=T) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866" )) + labs(x="Survey Area", y="Total Echo Bouts Detected")

esite_boxplot
```

```{r}
my_BuPu <- brewer.pal(n = 9, "BuPu")[3:9]

ectotal <- ggplot(dolphinz, aes((log1p(echo)),(log1p(dolphin)))) +
  geom_point(aes(group = site, color = site),  size = 3.5)+
  xlab("Total Echo Bouts Detected") + ylab("Total Dolphins Sighted") +
  scale_color_manual(name = "Survey Area", values  = my_BuPu)+
  scale_y_continuous(breaks = pretty_breaks()) + 
  theme_classic() +
  scale_x_continuous(breaks = pretty_breaks())
ectotal

ectotalszn <- ggplot(dolphinz, aes((log1p(echo)),(log1p(dolphin)))) +
  geom_point(aes(group = season, color = season),  size = 3.5)+
  xlab("Total Echo Bouts Detected") + ylab("Total Dolphins Sighted") +
  scale_color_manual(name = "Season", values  = my_BuPu)+
  scale_y_continuous(breaks = pretty_breaks()) + 
  theme_classic() +
  scale_x_continuous(breaks = pretty_breaks())
ectotalszn
```

log+1 Transformation with Season color code
```{r}
#with site
(mm_plot <- ggplot(dolphinz, aes(x = log1p(echo), y = log1p(dolphin))) +
      facet_wrap(~site, nrow=2) +   # a panel for each mountain range
      geom_point(alpha = 0.5, colour = "dark blue") +
      theme_classic() + labs(x  =  "Total Echo Bouts Detected", y = "Total Dolphins Sighted") +
      theme(legend.position = "none",
            panel.spacing = unit(2, "lines"))  # adding space between panels
)


#with season
(mm_plot <- ggplot(dolphinz, aes(x = log1p(echo), y = log1p(dolphin))) +
      facet_wrap(~season, nrow=2) +   # a panel for each mountain range
      geom_point(alpha = 0.5, colour = "dark blue") +
      theme_classic() + labs(x  =  "Total Echo Bouts Detected", y = "Total Dolphins Sighted") +
      theme(legend.position = "none",
            panel.spacing = unit(2, "lines"))  # adding space between panels
)
```


BP - Basic regression
```{r}
bplog.glm <- glm(log1p(dolphin) ~ log1p(bp) + calf + site + season + toad + perch, data = dolphinz)
summary(bplog.glm)
plot(bplog.glm)
bpalog.glm <- aov(bplog.glm)
summary(bpalog.glm)

bplog.glmnb <- glm.nb(dolphin ~ bp + calf + site + season + toad + perch, data = dolphinz)
summary(bplog.glm)
plot(bplog.glm)
bpalog.lm <- aov(bplog.glmnb)
summary(bpalog.glmnb)
```

```{r}
TK.dszn <- TK.test(dolphinz$dolphin, dolphinz$season, a=0.05)
TK.dszn

TK.bp <- TK.test(dolphinz$bp, dolphinz$site, a=0.05)
TK.bp

TK.bpszn <- TK.test(dolphinz$bp, dolphinz$season, a=0.05)
TK.bpszn
```

```{r}
par(mfrow=c(1,2))

plot(predict(bplog.lm), dolphinz$dolphin, xlab='Predicted Dolphins', ylab='Observed Dolphins', main = 'Model Predictability')
abline(a=0, b=1)

plot(predict(bplog.lm, type='response'), residuals(bplog.lm, type='response'), xlab='Fitted values', ylab='Residuals', main='Residuals vs Fitted Values')
```

```{r}

(prelim_plot <- ggplot(dolphinz, aes(x = log1p(bp), y = log1p(dolphin))) +
  geom_point() + theme_classic() +
  geom_smooth(method = "glm"))

```

```{r}
#Pearson Correlations to further assess relationships with continuous variables
#Calf variable (p < 0.001 ) correlations with total dolphins sighted and total vocalizations detected
# total vocals ~ calf 
ggscatter(dolphinz, x = "calf", y = "bp",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Total Calves Sighted", ylab = "Total Burst Pulses Detected")+
  stat_cor(aes(x=log1p(echo), y=calf), label.x = 7)


#Toadfish variable (fish calling scores summed monthly across sites; p < 0.038) correlations with total #dolphins sighted and vocalizations detected
#echo bouts ~ toad fish call score sums
ggscatter(dolphinz, x = "toad", y = "echo",
          add = "reg.line",                         
          conf.int = TRUE ,      
 xlab = "Summed Toadfish Calling Scores", ylab = "Total Burst Pulses Detected")+
  stat_cor(aes(x=toad, y=log1p(echo)), label.x = 7)

```

log+1 Transformation with Season color code
```{r}
#with site
(mm_plot <- ggplot(dolphinz, aes(x = log1p(bp), y = dolphin)) +
      facet_wrap(~site, nrow=2) +   # a panel for each mountain range
      geom_point(alpha = 0.5, colour = "dark green") +
      theme_classic() +  labs(x  =  "Total Burst Pulses Detected", y = "Total Dolphins Sighted") +
      theme(legend.position = "none",
            panel.spacing = unit(2, "lines"))  # adding space between panels
)


#with season
(mm_plot <- ggplot(dolphinz, aes(x = log1p(bp), y = dolphin)) +
      facet_wrap(~season, nrow=2) +   # a panel for each mountain range
      geom_point(alpha = 0.5, colour = "dark green") +
      theme_classic() +  labs(x  =  "Total Burst Pulses Detected", y = "Total Dolphins Sighted") +
      theme(legend.position = "none",
            panel.spacing = unit(2, "lines"))  # adding space between panels
)
```

```{r}
my_BuPu <- brewer.pal(n = 9, "BuPu")[3:9]

bptotal <- ggplot(dolphinz, aes((log1p(bp)),(log1p(dolphin)))) +
  geom_point(aes(group = site, color = site),  size = 3.5)+
  xlab("Total Burst Pulses Detected") + ylab("Total Dolphins Sighted") +
  scale_color_manual(name = "Survey Area", values  = my_BuPu)+
  scale_y_continuous(breaks = pretty_breaks()) + 
  theme_classic() +
  scale_x_continuous(breaks = pretty_breaks())
bptotal

bptotalszn <- ggplot(dolphinz, aes((log1p(bp)),(log1p(dolphin)))) +
  geom_point(aes(group = season, color = season),  size = 3.5)+
  xlab("Total Burst Pulses Detected") + ylab("Total Dolphins Sighted") +
  scale_color_manual(name = "Season", values  = my_BuPu)+
  scale_y_continuous(breaks = pretty_breaks()) + 
  theme_classic() +
  scale_x_continuous(breaks = pretty_breaks())
bptotalszn
```

```{r}
#Burst pulses bout boxplots across recorder sites/survey areas

#dolphin ~ site
bp_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(bp), fill = site)) +
  geom_boxplot(show.legend=F) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866","#386cb0","#fdb462","#7fc97f")) +
  labs(x="Survey Area", y="Total Burst Pulses Sighted")

bp_boxplot

bpsite_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(bp), fill = season)) +
  geom_boxplot(show.legend=T) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866" )) + labs(x="Survey Area", y="Total Burst Pulses Detected")

bpsite_boxplot
```


WHISTLE - Basic regression
```{r}
whlog.glm <- glm(log1p(dolphin) ~ log1p(whist) + calf + site, data = dolphinz)
summary(whlog.glm)
plot(whlog.glm)
whalog.glm <- aov(whlog.glm)
summary(whalog.glm)
```

```{r}
library(DTK)
TK.whistle <- TK.test(dolphinz$whist, dolphinz$site, a=0.05)
TK.whistle

TK.whszn <- TK.test(dolphinz$whist, dolphinz$season, a=0.05)
TK.whszn
```


```{r}
par(mfrow=c(1,2))

plot(predict(whlog.lm), dolphinz$dolphin, xlab='Predicted Dolphins', ylab='Observed Dolphins', main = 'Model Predictability')
abline(a=0, b=1)

plot(predict(whlog.lm, type='response'), residuals(whlog.lm, type='response'), xlab='Fitted values', ylab='Residuals', main='Residuals vs Fitted Values')
```

```{r}

(prelim_plot <- ggplot(dolphinz, aes(x = log1p(whist), y = log1p(dolphin))) +
  geom_point() + theme_classic() +
  geom_smooth(method = "glm"))


```

log+1 Transformation with Season color code
```{r}
#with site
(mm_plot <- ggplot(dolphinz, aes(x = log1p(whist), y = log1p(dolphin))) +
      facet_wrap(~site, nrow=2) +   # a panel for each mountain range
      geom_point(alpha = 0.5, colour = "orange") +
      theme_classic() + labs(x  =  "Total Whistles Detected", y = "Total Dolphins Sighted") +
      theme(legend.position = "none",
            panel.spacing = unit(2, "lines")))


#with season
(mm_plot <- ggplot(dolphinz, aes(x = log1p(whist), y = log1p(dolphin))) +
      facet_wrap(~season, nrow=2) +   # a panel for each mountain range
      geom_point(alpha = 0.5, colour = "orange") +
      theme_classic() +  labs(x  =  "Total Whistles Detected", y = "Total Dolphins Sighted") +
      theme(legend.position = "none",
            panel.spacing = unit(2, "lines")))
```

```{r}
my_BuPu <- brewer.pal(n = 9, "BuPu")[3:9]

whtotal <- ggplot(dolphinz, aes((log1p(whist)),(log1p(dolphin)))) +
  geom_point(aes(group = site, color = site),  size = 3.5)+
  xlab("Total Whistles Detected") + ylab("Total Dolphins Sighted") +
  scale_color_manual(name = "Survey Area", values  = my_BuPu)+
  scale_y_continuous(breaks = pretty_breaks()) + 
  theme_classic() +
  scale_x_continuous(breaks = pretty_breaks())
whtotal

whtotalszn <- ggplot(dolphinz, aes((log1p(whist)),(log1p(dolphin)))) +
  geom_point(aes(group = season, color = season),  size = 3.5)+
  xlab("Total Whistles Detected") + ylab("Total Dolphins Sighted") +
  scale_color_manual(name = "Season", values  = my_BuPu)+
  scale_y_continuous(breaks = pretty_breaks()) + 
  theme_classic() +
  scale_x_continuous(breaks = pretty_breaks())
whtotalszn
```

```{r}
#Whistles boxplots across recorder sites/survey areas

#dolphin ~ site
wh_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(whist), fill = site)) +
  geom_boxplot(show.legend=F) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866","#386cb0","#fdb462","#7fc97f")) +
  labs(x="Survey Area", y="Total Whistles Detected")

wh_boxplot

whsite_boxplot = ggplot(data=dolphinz, aes(x=site, y=log1p(whist), fill = season)) +
  geom_boxplot(show.legend=T) + theme_classic()+
  scale_fill_manual(values = c("#a6cee3","#A2D9CE","#566573", "#E59866" )) + labs(x="Survey Area", y="Total Whistles Detected")

whsite_boxplot
```

---
